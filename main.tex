% main.tex - an example LaTeX file to demonstrate the usage of uestcLetter.cls
%
% Template originally created by Brian Wood (brian.wood@oregonstate.edu). Please feel free to send suggestions for improvements; this template/cls may not be perfectly optimized.
% Modified by Shaozuo Yu (AugustYum@outlook.com) to suit the requirements of Tongji students.
% Further modifications and maintenance by Rizhong Lin (rizhonglin@tongji.edu.cn) as of May 22, 2023.
% Modified by Ziyi Wang (ziyiwhat@gmail.com) to suit the requirements of UESTC students in Aug 2025.
%
% Copyright 2025 Ziyi Wang
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3 or later is part of all distributions of LaTeX
% version 2003/12/01 or later.
%
% This work has the LPPL maintenance status "maintained".
%
% The Current Maintainer of this work is Ziyi Wang.
%
% This work consists of all the *.tex, *.cls and *.sty files in
%   https://github.com/ziyiwhat/UESTC-RecommendationLetter-Template

\documentclass[12pt]{uestcLetter}
\usepackage{tikz}
\usepackage{xcolor}
  \definecolor{uestcblue}{rgb}{0, 0.216, 0.608}
\usepackage[english]{babel}
\usepackage{lipsum}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{graphicx}
\usepackage{eso-pic}
\usepackage[colorlinks=true,linkcolor=black,urlcolor=black]{hyperref}

% Set up fancy page style for page numbering
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
\rhead{Page \thepage \hspace{1pt} of \pageref{LastPage}}

\newcommand{\watermark}[3]{\AddToShipoutPictureBG{
\parbox[b][\paperheight]{\paperwidth}{
\vfill%
\centering%
\begin{tikzpicture}
    \path (0,0) -- (\paperwidth,\paperheight);
    \node[opacity=.1] at (current page.center)
    {\includegraphics[width=0.55\textwidth]{figures/UESTC_bg.pdf}};
\end{tikzpicture}
\vfill}}}

% Define custom coordinate system for \tikz
\makeatletter
\def\parsecomma#1,#2\endparsecomma{\def\page@x{#1}\def\page@y{#2}}
\tikzdeclarecoordinatesystem{page}{
    \parsecomma#1\endparsecomma
    \pgfpointanchor{current page}{north east}
    \pgf@xc=\pgf@x%
    \pgf@yc=\pgf@y%
    \pgfpointanchor{current page}{south west}
    \pgf@xb=\pgf@x%
    \pgf@yb=\pgf@y%
    \pgfmathparse{(\pgf@xc-\pgf@xb)/2.*\page@x+(\pgf@xc+\pgf@xb)/2.}
    \expandafter\pgf@x\expandafter=\pgfmathresult pt
    \pgfmathparse{(\pgf@yc-\pgf@yb)/2.*\page@y+(\pgf@yc+\pgf@yb)/2.}
    \expandafter\pgf@y\expandafter=\pgfmathresult pt
}
\makeatother

%%%%%%%%%%% Put Personal Information Here %%%%%%%%%%%
\def\name{Prof. PNAME \\
COLLEGE NAME  \\
University of Electronic Science and Technology of China \\
Email: EMAIL \\
Homepage: HOMEPAGE
}

%%%%%%%%%%%%  Additional Contact Information %%%%%%%%%%%
\def\Where{%
    School of Information and \\ Communication Engineering,
}

\def\Address{%
    No.2006, Xiyuan Ave,\\
    West Hi-Tech Zone,
}

\def\CityZip{Chengdu, Sichuan, 611731}

%%%%%%%%%%%%%%%%  Footer information  %%%%%%%%%%%%%%%%%%
\def\school{\small{
    University of Electronic Science and Technology of China $\cdot$
    No.2006, Xiyuan Ave, $\cdot$
    Chengdu, Sichuan}
}

\cfoot{\school}



%%%%%%%%%%%%%%%%%%%%%  Signature line  %%%%%%%%%%%%%%%%%%%%%
\signature{
    \IfFileExists{figures/signature.pdf}{
    \vspace{-12mm}\includegraphics[scale=0.40]{figures/signature.pdf}\\\vspace{-2mm}
}{
    \vspace{9mm}
}
    \name
}

\address{}

\def\newaddress{%
    \Where\\
    \Address\\
    \CityZip\\
}

%%%%%%%%%%%  DATE  %%%%%%%%%%%%%%%%%%%%%%%%%
\date{\vspace{10mm} \today}

%%%%%%%%%%% Set the subject here if there is one  %%%%
% \subject{Letter of Recommendation} % optional subject line

\begin{document}

\begin{letter}{
        To Whom It May Concern,
    }

    \begin{tikzpicture}[remember picture,overlay,,every node/.style={anchor=center}]
        \node[text width=7cm] at (page cs:0.65,0.73){\small \newaddress};
    \end{tikzpicture}

    \opening{}

    % Remove it if you do not want the Tongji logo watermark
    \watermark{}{}{}

    \input{content.tex}

    \closing{Faithfully submitted,}

    % Comment out/in the lines below as necessary
    %\encl{If an enclosure is provided, let them know what it is.}

    %\ps{A postscript if that is a thing you do.}

    %\cc{Someone Who Cares (and is copied).}

\end{letter}

\end{document}
